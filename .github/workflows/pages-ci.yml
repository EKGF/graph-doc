name: Docs Site CI

on:
  push:
    branches:
      - "main"
      - "feature/**"
  pull_request:
    branches:
      - "main"
  # Run manually
  workflow_dispatch:

jobs:
  # Build job
  pages-build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          sparse-checkout: docs
      - name: Move & Show
        run: |
          rm Cargo.toml Cargo.lock cog.toml *.code* *.sh rust*
          shopt -s dotglob ; mv docs/* .
          rm -rf docs
          rm *.sh
          ls -R
      - name: Setup Ruby
        uses: ruby/setup-ruby@v1
        with:
          bundler-cache: true # runs 'bundle install' and caches installed gems automatically
          cache-version: 0 # Increment this number if you need to re-download cached gems
      - name: Build with Jekyll
        run: bundle exec jekyll build
